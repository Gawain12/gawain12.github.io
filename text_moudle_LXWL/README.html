<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Text Classification with CNN and RNN使用卷积神经网络进行中文文本分类 环境 Python 3.6.8 TensorFlow 1.8.0 numpy scikit-learn scipy  数据集本训练集由predict_check_data表的17万条产品名称和对应分类组成。 预处理data_prepare.py运行该程序，即可根据数据表，生成指定的训练，测试，">
<meta property="og:type" content="website">
<meta property="og:title" content="谭凯元的随笔">
<meta property="og:url" content="https://www.gawain.site/text_moudle_LXWL/README.html">
<meta property="og:site_name" content="谭凯元的随笔">
<meta property="og:description" content="Text Classification with CNN and RNN使用卷积神经网络进行中文文本分类 环境 Python 3.6.8 TensorFlow 1.8.0 numpy scikit-learn scipy  数据集本训练集由predict_check_data表的17万条产品名称和对应分类组成。 预处理data_prepare.py运行该程序，即可根据数据表，生成指定的训练，测试，">
<meta property="article:published_time" content="2021-06-25T12:45:38.451Z">
<meta property="article:modified_time" content="2021-06-25T12:45:38.451Z">
<meta property="article:author" content="谭凯元">
<meta property="article:tag" content="Share">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.gawain.site/text_moudle_LXWL/README.html"/>





  <title> | 谭凯元的随笔</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">谭凯元的随笔</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Gawain的个人生活与技术分享</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-resume">
          <a href="/Resume/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            个人简介
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-gallery">
          <a href="/gallery/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-camera"></i> <br />
            
            相册
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h2 class="post-title" itemprop="name headline"></h2>



</header>

      
      
      
      <div class="post-body">
        
        
          <h1 id="Text-Classification-with-CNN-and-RNN"><a href="#Text-Classification-with-CNN-and-RNN" class="headerlink" title="Text Classification with CNN and RNN"></a>Text Classification with CNN and RNN</h1><p>使用卷积神经网络进行中文文本分类</p>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul>
<li>Python 3.6.8</li>
<li>TensorFlow 1.8.0</li>
<li>numpy</li>
<li>scikit-learn</li>
<li>scipy</li>
</ul>
<h2 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h2><p>本训练集由predict_check_data表的17万条产品名称和对应分类组成。</p>
<h2 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h2><p><code>data_prepare.py</code>运行该程序，即可根据数据表，生成指定的训练，测试，验证集。</p>
<p><code>data/cnews_loader.py</code>为数据的预处理文件。</p>
<ul>
<li><code>read_file()</code>: 读取文件数据;</li>
<li><code>build_vocab()</code>: 构建词汇表，使用字符级的表示，这一函数会将词汇表存储下来，避免每一次重复处理;</li>
<li><code>read_vocab()</code>: 读取上一步存储的词汇表，转换为<code>{词：id}</code>表示;</li>
<li><code>read_category()</code>: 将分类目录固定，转换为<code>{类别: id}</code>表示;</li>
<li><code>to_words()</code>: 将一条由id表示的数据重新转换为文字;</li>
<li><code>process_file()</code>: 将数据集从文字转换为固定长度的id序列表示;</li>
<li><code>batch_iter()</code>: 为神经网络的训练准备经过shuffle的批次的数据。</li>
</ul>
<p>经过数据预处理，数据的格式如下：</p>
<table>
<thead>
<tr>
<th align="left">Data</th>
<th align="left">Shape</th>
<th align="left">Data</th>
<th align="left">Shape</th>
</tr>
</thead>
<tbody><tr>
<td align="left">x_train</td>
<td align="left">[50000, 600]</td>
<td align="left">y_train</td>
<td align="left">[50000, 10]</td>
</tr>
<tr>
<td align="left">x_val</td>
<td align="left">[5000, 600]</td>
<td align="left">y_val</td>
<td align="left">[5000, 10]</td>
</tr>
<tr>
<td align="left">x_test</td>
<td align="left">[10000, 600]</td>
<td align="left">y_test</td>
<td align="left">[10000, 10]</td>
</tr>
</tbody></table>
<h2 id="CNN卷积神经网络"><a href="#CNN卷积神经网络" class="headerlink" title="CNN卷积神经网络"></a>CNN卷积神经网络</h2><h3 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h3><p>CNN可配置的参数如下所示，在<code>cnn_model.py</code>中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TCNNConfig</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""CNN配置参数"""</span></span><br><span class="line"></span><br><span class="line">    embedding_dim = <span class="number">128</span>  <span class="comment"># 词向量维度</span></span><br><span class="line">    seq_length = <span class="number">300</span>  <span class="comment"># 序列长度</span></span><br><span class="line">    <span class="comment"># num_classes = 668  # 类别数</span></span><br><span class="line">    num_filters = <span class="number">1024</span>  <span class="comment"># 卷积核数目</span></span><br><span class="line">    kernel_size = <span class="number">3</span>  <span class="comment"># 卷积核尺寸</span></span><br><span class="line">    vocab_size = <span class="number">8000</span>  <span class="comment"># 词汇表大小</span></span><br><span class="line"></span><br><span class="line">    hidden_dim = <span class="number">256</span>  <span class="comment"># 全连接层神经元</span></span><br><span class="line"></span><br><span class="line">    dropout_keep_prob = <span class="number">0.55</span>  <span class="comment"># dropout保留比例</span></span><br><span class="line">    learning_rate = <span class="number">1e-3</span>  <span class="comment"># 学习率</span></span><br><span class="line"></span><br><span class="line">    batch_size = <span class="number">64</span>  <span class="comment"># 每批训练大小</span></span><br><span class="line">    num_epochs = <span class="number">20</span>  <span class="comment"># 总迭代轮次</span></span><br><span class="line"></span><br><span class="line">    print_per_batch = <span class="number">100</span>  <span class="comment"># 每多少轮输出一次结果</span></span><br><span class="line">    save_per_batch = <span class="number">10</span>  <span class="comment"># 每多少轮存入tensorboard</span></span><br></pre></td></tr></table></figure>

<h3 id="CNN模型"><a href="#CNN模型" class="headerlink" title="CNN模型"></a>CNN模型</h3><p>具体参看<code>cnn_model.py</code>的实现。</p>
<h3 id="训练与验证"><a href="#训练与验证" class="headerlink" title="训练与验证"></a>训练与验证</h3><p>运行 <code>python run_cnn.py train</code>，可以开始训练。</p>
<blockquote>
<p>若之前进行过训练，请把tensorboard/textcnn删除，避免TensorBoard多次训练结果重叠。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line">Configuring CNN model...</span><br><span class="line">Configuring TensorBoard and Saver...</span><br><span class="line">Loading training and validation data...</span><br><span class="line">Time usage: 0:00:14</span><br><span class="line">Training and evaluating...</span><br><span class="line">Epoch: 1</span><br><span class="line">Iter:      0, Train Loss:    8.9, Train Acc:   0.00%, Val Loss:    8.9, Val Acc:   0.00%, Time: 0:00:15</span><br><span class="line">Iter:    100, Train Loss:    7.1, Train Acc:   3.12%, Val Loss:    7.3, Val Acc:   1.75%, Time: 0:00:22 *</span><br><span class="line">Iter:    200, Train Loss:    6.7, Train Acc:   9.38%, Val Loss:    6.9, Val Acc:   7.68%, Time: 0:00:29 *</span><br><span class="line">Iter:    300, Train Loss:    5.8, Train Acc:  20.31%, Val Loss:    6.4, Val Acc:  15.43%, Time: 0:00:35 *</span><br><span class="line">Iter:    400, Train Loss:    5.8, Train Acc:  18.75%, Val Loss:    5.8, Val Acc:  23.33%, Time: 0:00:42 *</span><br><span class="line">Iter:    500, Train Loss:    5.4, Train Acc:  29.69%, Val Loss:    5.3, Val Acc:  30.68%, Time: 0:00:49 *</span><br><span class="line">Iter:    600, Train Loss:    4.1, Train Acc:  40.62%, Val Loss:    5.0, Val Acc:  37.10%, Time: 0:00:56 *</span><br><span class="line">Iter:    700, Train Loss:    4.3, Train Acc:  40.62%, Val Loss:    4.7, Val Acc:  39.64%, Time: 0:01:03 *</span><br><span class="line">Iter:    800, Train Loss:    4.1, Train Acc:  48.44%, Val Loss:    4.5, Val Acc:  43.47%, Time: 0:01:10 *</span><br><span class="line">Iter:    900, Train Loss:    4.2, Train Acc:  37.50%, Val Loss:    4.3, Val Acc:  45.70%, Time: 0:01:17 *</span><br><span class="line">Iter:   1000, Train Loss:    3.0, Train Acc:  56.25%, Val Loss:    4.1, Val Acc:  48.36%, Time: 0:01:23 *</span><br><span class="line">Iter:   1100, Train Loss:    4.3, Train Acc:  50.00%, Val Loss:    4.0, Val Acc:  50.28%, Time: 0:01:30 *</span><br><span class="line">Iter:   1200, Train Loss:    3.5, Train Acc:  53.12%, Val Loss:    3.9, Val Acc:  51.55%, Time: 0:01:37 *</span><br><span class="line">Iter:   1300, Train Loss:    4.2, Train Acc:  50.00%, Val Loss:    3.8, Val Acc:  52.80%, Time: 0:01:44 *</span><br><span class="line">Iter:   1400, Train Loss:    2.6, Train Acc:  59.38%, Val Loss:    3.6, Val Acc:  54.80%, Time: 0:01:51 *</span><br><span class="line">Iter:   1500, Train Loss:    4.0, Train Acc:  51.56%, Val Loss:    3.5, Val Acc:  55.76%, Time: 0:01:58 *</span><br><span class="line">Iter:   1600, Train Loss:    4.1, Train Acc:  46.88%, Val Loss:    3.5, Val Acc:  56.52%, Time: 0:02:05 *</span><br><span class="line">Iter:   1700, Train Loss:    3.0, Train Acc:  59.38%, Val Loss:    3.4, Val Acc:  57.38%, Time: 0:02:12 *</span><br><span class="line">Iter:   1800, Train Loss:    2.9, Train Acc:  60.94%, Val Loss:    3.3, Val Acc:  58.31%, Time: 0:02:19 *</span><br><span class="line">Iter:   1900, Train Loss:    3.8, Train Acc:  50.00%, Val Loss:    3.2, Val Acc:  58.58%, Time: 0:02:26 *</span><br><span class="line">Iter:   2000, Train Loss:    3.9, Train Acc:  54.69%, Val Loss:    3.2, Val Acc:  59.42%, Time: 0:02:33 *</span><br><span class="line">Epoch: 2</span><br><span class="line">Iter:   2100, Train Loss:    2.6, Train Acc:  62.50%, Val Loss:    3.1, Val Acc:  60.42%, Time: 0:02:50 *</span><br><span class="line">Iter:   2200, Train Loss:    2.4, Train Acc:  70.31%, Val Loss:    3.0, Val Acc:  61.14%, Time: 0:02:57 *</span><br><span class="line">Iter:   2300, Train Loss:    2.5, Train Acc:  62.50%, Val Loss:    3.0, Val Acc:  61.55%, Time: 0:03:04 *</span><br><span class="line">Iter:   2400, Train Loss:    1.9, Train Acc:  71.88%, Val Loss:    2.9, Val Acc:  62.67%, Time: 0:03:11 *</span><br><span class="line">Iter:   2500, Train Loss:    2.0, Train Acc:  68.75%, Val Loss:    2.9, Val Acc:  62.93%, Time: 0:03:18 *</span><br><span class="line">Iter:   2600, Train Loss:    2.0, Train Acc:  67.19%, Val Loss:    2.8, Val Acc:  63.42%, Time: 0:03:24 *</span><br><span class="line">Iter:   2700, Train Loss:    2.1, Train Acc:  62.50%, Val Loss:    2.8, Val Acc:  63.86%, Time: 0:03:31 *</span><br><span class="line">Iter:   2800, Train Loss:    2.3, Train Acc:  71.88%, Val Loss:    2.7, Val Acc:  64.37%, Time: 0:03:38 *</span><br><span class="line">Iter:   2900, Train Loss:    2.0, Train Acc:  70.31%, Val Loss:    2.7, Val Acc:  64.58%, Time: 0:03:45 *</span><br><span class="line">Iter:   3000, Train Loss:    2.7, Train Acc:  59.38%, Val Loss:    2.6, Val Acc:  65.34%, Time: 0:03:52 *</span><br><span class="line">Iter:   3100, Train Loss:    1.9, Train Acc:  67.19%, Val Loss:    2.5, Val Acc:  65.78%, Time: 0:03:59 *</span><br><span class="line">Iter:   3200, Train Loss:    1.8, Train Acc:  71.88%, Val Loss:    2.5, Val Acc:  66.57%, Time: 0:04:05 *</span><br><span class="line">Iter:   3300, Train Loss:    2.2, Train Acc:  67.19%, Val Loss:    2.5, Val Acc:  66.99%, Time: 0:04:12 *</span><br><span class="line">Iter:   3400, Train Loss:    2.6, Train Acc:  68.75%, Val Loss:    2.4, Val Acc:  67.20%, Time: 0:04:19 *</span><br><span class="line">Iter:   3500, Train Loss:    2.5, Train Acc:  65.62%, Val Loss:    2.4, Val Acc:  67.61%, Time: 0:04:26 *</span><br><span class="line">Iter:   3600, Train Loss:   0.86, Train Acc:  84.38%, Val Loss:    2.3, Val Acc:  68.21%, Time: 0:04:33 *</span><br><span class="line">Iter:   3700, Train Loss:    1.8, Train Acc:  70.31%, Val Loss:    2.3, Val Acc:  67.93%, Time: 0:04:39</span><br><span class="line">Iter:   3800, Train Loss:    1.4, Train Acc:  78.12%, Val Loss:    2.3, Val Acc:  68.91%, Time: 0:04:46 *</span><br><span class="line">Iter:   3900, Train Loss:    2.0, Train Acc:  71.88%, Val Loss:    2.2, Val Acc:  69.15%, Time: 0:04:53 *</span><br><span class="line">Iter:   4000, Train Loss:    1.7, Train Acc:  71.88%, Val Loss:    2.2, Val Acc:  69.55%, Time: 0:05:00 *</span><br><span class="line">Iter:   4100, Train Loss:    1.3, Train Acc:  79.69%, Val Loss:    2.1, Val Acc:  70.02%, Time: 0:05:07 *</span><br><span class="line">Epoch: 3</span><br><span class="line">Iter:   4200, Train Loss:   0.92, Train Acc:  82.81%, Val Loss:    2.1, Val Acc:  70.36%, Time: 0:05:20 *</span><br><span class="line">Iter:   4300, Train Loss:    0.9, Train Acc:  81.25%, Val Loss:    2.1, Val Acc:  70.28%, Time: 0:05:27</span><br><span class="line">Iter:   4400, Train Loss:    1.4, Train Acc:  81.25%, Val Loss:    2.0, Val Acc:  71.39%, Time: 0:05:33 *</span><br><span class="line">Iter:   4500, Train Loss:    1.3, Train Acc:  78.12%, Val Loss:    2.0, Val Acc:  71.21%, Time: 0:05:40</span><br><span class="line">Iter:   4600, Train Loss:    1.4, Train Acc:  81.25%, Val Loss:    2.0, Val Acc:  72.01%, Time: 0:05:47 *</span><br><span class="line">Iter:   4700, Train Loss:    1.2, Train Acc:  79.69%, Val Loss:    1.9, Val Acc:  72.46%, Time: 0:05:53 *</span><br><span class="line">Iter:   4800, Train Loss:   0.94, Train Acc:  87.50%, Val Loss:    1.9, Val Acc:  72.70%, Time: 0:06:00 *</span><br><span class="line">Iter:   4900, Train Loss:    1.7, Train Acc:  76.56%, Val Loss:    1.9, Val Acc:  73.00%, Time: 0:06:07 *</span><br><span class="line">Iter:   5000, Train Loss:   0.98, Train Acc:  82.81%, Val Loss:    1.8, Val Acc:  73.68%, Time: 0:06:14 *</span><br><span class="line">Iter:   5100, Train Loss:    1.4, Train Acc:  78.12%, Val Loss:    1.8, Val Acc:  73.69%, Time: 0:06:21 *</span><br><span class="line">Iter:   5200, Train Loss:    1.5, Train Acc:  71.88%, Val Loss:    1.8, Val Acc:  74.32%, Time: 0:06:28 *</span><br><span class="line">Iter:   5300, Train Loss:   0.78, Train Acc:  85.94%, Val Loss:    1.8, Val Acc:  74.16%, Time: 0:06:34</span><br><span class="line">Iter:   5400, Train Loss:   0.95, Train Acc:  78.12%, Val Loss:    1.7, Val Acc:  74.41%, Time: 0:06:41 *</span><br><span class="line">Iter:   5500, Train Loss:   0.96, Train Acc:  85.94%, Val Loss:    1.7, Val Acc:  75.29%, Time: 0:06:48 *</span><br><span class="line">Iter:   5600, Train Loss:    1.2, Train Acc:  82.81%, Val Loss:    1.7, Val Acc:  75.43%, Time: 0:06:55 *</span><br><span class="line">Iter:   5700, Train Loss:    1.3, Train Acc:  76.56%, Val Loss:    1.7, Val Acc:  75.19%, Time: 0:07:01</span><br><span class="line">Iter:   5800, Train Loss:    1.0, Train Acc:  81.25%, Val Loss:    1.6, Val Acc:  76.09%, Time: 0:07:08 *</span><br><span class="line">Iter:   5900, Train Loss:    0.8, Train Acc:  81.25%, Val Loss:    1.6, Val Acc:  76.16%, Time: 0:07:15 *</span><br><span class="line">Iter:   6000, Train Loss:    1.2, Train Acc:  76.56%, Val Loss:    1.6, Val Acc:  76.21%, Time: 0:07:22 *</span><br><span class="line">Iter:   6100, Train Loss:    1.3, Train Acc:  78.12%, Val Loss:    1.6, Val Acc:  76.62%, Time: 0:07:29 *</span><br><span class="line">Iter:   6200, Train Loss:   0.92, Train Acc:  85.94%, Val Loss:    1.5, Val Acc:  77.45%, Time: 0:07:35 *</span><br><span class="line">Epoch: 4</span><br><span class="line">Iter:   6300, Train Loss:    0.3, Train Acc:  96.88%, Val Loss:    1.5, Val Acc:  77.37%, Time: 0:07:48</span><br><span class="line">Iter:   6400, Train Loss:   0.72, Train Acc:  89.06%, Val Loss:    1.5, Val Acc:  77.80%, Time: 0:07:54 *</span><br><span class="line">Iter:   6500, Train Loss:   0.46, Train Acc:  90.62%, Val Loss:    1.5, Val Acc:  77.54%, Time: 0:08:01</span><br><span class="line">Iter:   6600, Train Loss:   0.38, Train Acc:  92.19%, Val Loss:    1.5, Val Acc:  78.04%, Time: 0:08:08 *</span><br><span class="line">Iter:   6700, Train Loss:   0.78, Train Acc:  90.62%, Val Loss:    1.4, Val Acc:  78.41%, Time: 0:08:14 *</span><br><span class="line">Iter:   6800, Train Loss:   0.93, Train Acc:  81.25%, Val Loss:    1.4, Val Acc:  78.65%, Time: 0:08:21 *</span><br><span class="line">Iter:   6900, Train Loss:   0.43, Train Acc:  92.19%, Val Loss:    1.4, Val Acc:  79.00%, Time: 0:08:28 *</span><br><span class="line">Iter:   7000, Train Loss:   0.48, Train Acc:  92.19%, Val Loss:    1.4, Val Acc:  78.81%, Time: 0:08:34</span><br><span class="line">Iter:   7100, Train Loss:   0.25, Train Acc:  95.31%, Val Loss:    1.4, Val Acc:  78.78%, Time: 0:08:41</span><br><span class="line">Iter:   7200, Train Loss:   0.79, Train Acc:  84.38%, Val Loss:    1.4, Val Acc:  79.45%, Time: 0:08:48 *</span><br><span class="line">Iter:   7300, Train Loss:   0.64, Train Acc:  89.06%, Val Loss:    1.4, Val Acc:  79.34%, Time: 0:08:54</span><br><span class="line">Iter:   7400, Train Loss:   0.43, Train Acc:  92.19%, Val Loss:    1.3, Val Acc:  79.44%, Time: 0:09:01</span><br><span class="line">Iter:   7500, Train Loss:    0.6, Train Acc:  90.62%, Val Loss:    1.3, Val Acc:  80.37%, Time: 0:09:07 *</span><br><span class="line">Iter:   7600, Train Loss:   0.57, Train Acc:  90.62%, Val Loss:    1.3, Val Acc:  80.30%, Time: 0:09:14</span><br><span class="line">Iter:   7700, Train Loss:   0.59, Train Acc:  85.94%, Val Loss:    1.3, Val Acc:  80.73%, Time: 0:09:21 *</span><br><span class="line">Iter:   7800, Train Loss:   0.35, Train Acc:  92.19%, Val Loss:    1.2, Val Acc:  81.22%, Time: 0:09:28 *</span><br><span class="line">Iter:   7900, Train Loss:   0.37, Train Acc:  92.19%, Val Loss:    1.2, Val Acc:  81.54%, Time: 0:09:34 *</span><br><span class="line">Iter:   8000, Train Loss:   0.67, Train Acc:  84.38%, Val Loss:    1.2, Val Acc:  81.40%, Time: 0:09:41</span><br><span class="line">Iter:   8100, Train Loss:   0.56, Train Acc:  90.62%, Val Loss:    1.2, Val Acc:  81.64%, Time: 0:09:48 *</span><br><span class="line">Iter:   8200, Train Loss:   0.62, Train Acc:  90.62%, Val Loss:    1.2, Val Acc:  81.83%, Time: 0:09:55 *</span><br><span class="line">Iter:   8300, Train Loss:   0.47, Train Acc:  90.62%, Val Loss:    1.1, Val Acc:  81.90%, Time: 0:10:01 *</span><br><span class="line">Epoch: 5</span><br><span class="line">Iter:   8400, Train Loss:   0.36, Train Acc:  93.75%, Val Loss:    1.1, Val Acc:  82.03%, Time: 0:10:14 *</span><br><span class="line">Iter:   8500, Train Loss:   0.48, Train Acc:  90.62%, Val Loss:    1.1, Val Acc:  82.38%, Time: 0:10:21 *</span><br><span class="line">Iter:   8600, Train Loss:   0.91, Train Acc:  82.81%, Val Loss:    1.1, Val Acc:  82.23%, Time: 0:10:28</span><br><span class="line">Iter:   8700, Train Loss:   0.39, Train Acc:  93.75%, Val Loss:    1.1, Val Acc:  82.63%, Time: 0:10:34 *</span><br><span class="line">Iter:   8800, Train Loss:   0.45, Train Acc:  92.19%, Val Loss:    1.1, Val Acc:  83.23%, Time: 0:10:41 *</span><br><span class="line">Iter:   8900, Train Loss:   0.29, Train Acc:  95.31%, Val Loss:    1.1, Val Acc:  83.23%, Time: 0:10:48 *</span><br><span class="line">Iter:   9000, Train Loss:    1.0, Train Acc:  85.94%, Val Loss:    1.1, Val Acc:  83.25%, Time: 0:10:55 *</span><br><span class="line">Iter:   9100, Train Loss:   0.22, Train Acc:  93.75%, Val Loss:    1.1, Val Acc:  82.89%, Time: 0:11:02</span><br><span class="line">Iter:   9200, Train Loss:   0.49, Train Acc:  92.19%, Val Loss:    1.1, Val Acc:  83.14%, Time: 0:11:08</span><br><span class="line">Iter:   9300, Train Loss:   0.34, Train Acc:  92.19%, Val Loss:    1.0, Val Acc:  83.49%, Time: 0:11:15 *</span><br><span class="line">Iter:   9400, Train Loss:   0.25, Train Acc:  96.88%, Val Loss:    1.1, Val Acc:  83.13%, Time: 0:11:22</span><br><span class="line">Iter:   9500, Train Loss:   0.37, Train Acc:  93.75%, Val Loss:    1.0, Val Acc:  84.14%, Time: 0:11:28 *</span><br><span class="line">Iter:   9600, Train Loss:   0.25, Train Acc:  93.75%, Val Loss:   0.99, Val Acc:  83.97%, Time: 0:11:35</span><br><span class="line">Iter:   9700, Train Loss:   0.31, Train Acc:  92.19%, Val Loss:    1.0, Val Acc:  83.88%, Time: 0:11:42</span><br><span class="line">Iter:   9800, Train Loss:   0.31, Train Acc:  92.19%, Val Loss:    1.0, Val Acc:  84.00%, Time: 0:11:48</span><br><span class="line">Iter:   9900, Train Loss:   0.22, Train Acc:  93.75%, Val Loss:   0.96, Val Acc:  84.53%, Time: 0:11:55 *</span><br><span class="line">Iter:  10000, Train Loss:   0.45, Train Acc:  96.88%, Val Loss:   0.96, Val Acc:  84.62%, Time: 0:12:02 *</span><br><span class="line">Iter:  10100, Train Loss:   0.32, Train Acc:  96.88%, Val Loss:   0.94, Val Acc:  84.88%, Time: 0:12:09 *</span><br><span class="line">Iter:  10200, Train Loss:   0.47, Train Acc:  87.50%, Val Loss:   0.96, Val Acc:  84.56%, Time: 0:12:15</span><br><span class="line">Iter:  10300, Train Loss:   0.32, Train Acc:  95.31%, Val Loss:   0.92, Val Acc:  85.14%, Time: 0:12:22 *</span><br><span class="line">Epoch: 6</span><br><span class="line">Iter:  10400, Train Loss:   0.28, Train Acc:  95.31%, Val Loss:   0.92, Val Acc:  84.80%, Time: 0:12:34</span><br><span class="line">Iter:  10500, Train Loss:   0.12, Train Acc:  98.44%, Val Loss:   0.89, Val Acc:  85.43%, Time: 0:12:41 *</span><br><span class="line">Iter:  10600, Train Loss:   0.17, Train Acc:  96.88%, Val Loss:   0.93, Val Acc:  84.99%, Time: 0:12:47</span><br><span class="line">Iter:  10700, Train Loss:   0.35, Train Acc:  92.19%, Val Loss:    0.9, Val Acc:  85.60%, Time: 0:12:54 *</span><br><span class="line">Iter:  10800, Train Loss:   0.22, Train Acc:  96.88%, Val Loss:   0.92, Val Acc:  85.43%, Time: 0:13:01</span><br><span class="line">Iter:  10900, Train Loss:   0.19, Train Acc:  95.31%, Val Loss:   0.88, Val Acc:  85.58%, Time: 0:13:08</span><br><span class="line">Iter:  11000, Train Loss:    0.4, Train Acc:  92.19%, Val Loss:   0.91, Val Acc:  85.28%, Time: 0:13:14</span><br><span class="line">Iter:  11100, Train Loss:   0.22, Train Acc:  93.75%, Val Loss:   0.87, Val Acc:  85.60%, Time: 0:13:21 *</span><br><span class="line">Iter:  11200, Train Loss:   0.14, Train Acc:  98.44%, Val Loss:   0.89, Val Acc:  85.70%, Time: 0:13:27 *</span><br><span class="line">Iter:  11300, Train Loss:    0.2, Train Acc:  92.19%, Val Loss:   0.88, Val Acc:  85.78%, Time: 0:13:34 *</span><br><span class="line">Iter:  11400, Train Loss:    0.3, Train Acc:  92.19%, Val Loss:   0.84, Val Acc:  86.32%, Time: 0:13:41 *</span><br><span class="line">Iter:  11500, Train Loss:   0.26, Train Acc:  93.75%, Val Loss:   0.84, Val Acc:  86.26%, Time: 0:13:48</span><br><span class="line">Iter:  11600, Train Loss:   0.29, Train Acc:  96.88%, Val Loss:   0.81, Val Acc:  86.61%, Time: 0:13:54 *</span><br><span class="line">Iter:  11700, Train Loss:   0.38, Train Acc:  92.19%, Val Loss:   0.81, Val Acc:  86.89%, Time: 0:14:01 *</span><br><span class="line">Iter:  11800, Train Loss:   0.22, Train Acc:  98.44%, Val Loss:   0.79, Val Acc:  86.84%, Time: 0:14:08</span><br><span class="line">Iter:  11900, Train Loss:   0.35, Train Acc:  90.62%, Val Loss:    0.8, Val Acc:  86.77%, Time: 0:14:14</span><br><span class="line">Iter:  12000, Train Loss:   0.14, Train Acc:  98.44%, Val Loss:    0.8, Val Acc:  86.89%, Time: 0:14:21 *</span><br><span class="line">Iter:  12100, Train Loss:   0.13, Train Acc:  95.31%, Val Loss:   0.79, Val Acc:  86.68%, Time: 0:14:28</span><br><span class="line">Iter:  12200, Train Loss:   0.44, Train Acc:  96.88%, Val Loss:   0.78, Val Acc:  87.13%, Time: 0:14:34 *</span><br><span class="line">Iter:  12300, Train Loss:   0.45, Train Acc:  92.19%, Val Loss:   0.76, Val Acc:  87.41%, Time: 0:14:41 *</span><br><span class="line">Iter:  12400, Train Loss:   0.15, Train Acc:  95.31%, Val Loss:   0.76, Val Acc:  87.46%, Time: 0:14:48 *</span><br><span class="line">Epoch: 7</span><br><span class="line">Iter:  12500, Train Loss:  0.092, Train Acc:  98.44%, Val Loss:   0.76, Val Acc:  87.37%, Time: 0:15:00</span><br><span class="line">Iter:  12600, Train Loss:  0.056, Train Acc: 100.00%, Val Loss:   0.73, Val Acc:  87.71%, Time: 0:15:07 *</span><br><span class="line">Iter:  12700, Train Loss:  0.061, Train Acc:  96.88%, Val Loss:   0.74, Val Acc:  87.62%, Time: 0:15:14</span><br><span class="line">Iter:  12800, Train Loss:  0.095, Train Acc:  98.44%, Val Loss:   0.77, Val Acc:  87.07%, Time: 0:15:21</span><br><span class="line">Iter:  12900, Train Loss:   0.12, Train Acc:  95.31%, Val Loss:   0.73, Val Acc:  87.55%, Time: 0:15:27</span><br><span class="line">Iter:  13000, Train Loss:   0.37, Train Acc:  92.19%, Val Loss:   0.74, Val Acc:  87.65%, Time: 0:15:34</span><br><span class="line">Iter:  13100, Train Loss:   0.22, Train Acc:  96.88%, Val Loss:   0.72, Val Acc:  87.91%, Time: 0:15:41 *</span><br><span class="line">Iter:  13200, Train Loss:   0.19, Train Acc:  96.88%, Val Loss:   0.74, Val Acc:  87.53%, Time: 0:15:47</span><br><span class="line">Iter:  13300, Train Loss:   0.21, Train Acc:  93.75%, Val Loss:   0.72, Val Acc:  87.75%, Time: 0:15:54</span><br><span class="line">Iter:  13400, Train Loss:   0.38, Train Acc:  96.88%, Val Loss:   0.71, Val Acc:  88.28%, Time: 0:16:01 *</span><br><span class="line">Iter:  13500, Train Loss:   0.32, Train Acc:  95.31%, Val Loss:   0.72, Val Acc:  88.10%, Time: 0:16:07</span><br><span class="line">Iter:  13600, Train Loss:   0.12, Train Acc:  96.88%, Val Loss:   0.75, Val Acc:  87.65%, Time: 0:16:14</span><br><span class="line">Iter:  13700, Train Loss:   0.27, Train Acc:  93.75%, Val Loss:   0.71, Val Acc:  88.32%, Time: 0:16:21 *</span><br><span class="line">Iter:  13800, Train Loss:   0.25, Train Acc:  95.31%, Val Loss:    0.7, Val Acc:  88.43%, Time: 0:16:27 *</span><br><span class="line">Iter:  13900, Train Loss:   0.15, Train Acc:  95.31%, Val Loss:   0.71, Val Acc:  88.19%, Time: 0:16:34</span><br><span class="line">Iter:  14000, Train Loss:   0.32, Train Acc:  92.19%, Val Loss:   0.69, Val Acc:  88.35%, Time: 0:16:41</span><br><span class="line">Iter:  14100, Train Loss:   0.27, Train Acc:  93.75%, Val Loss:   0.68, Val Acc:  88.20%, Time: 0:16:47</span><br><span class="line">Iter:  14200, Train Loss:  0.044, Train Acc:  98.44%, Val Loss:   0.64, Val Acc:  88.86%, Time: 0:16:54 *</span><br><span class="line">Iter:  14300, Train Loss:    0.1, Train Acc:  96.88%, Val Loss:   0.66, Val Acc:  88.62%, Time: 0:17:01</span><br><span class="line">Iter:  14400, Train Loss:  0.094, Train Acc:  98.44%, Val Loss:   0.65, Val Acc:  88.81%, Time: 0:17:07</span><br><span class="line">Iter:  14500, Train Loss:   0.46, Train Acc:  90.62%, Val Loss:   0.63, Val Acc:  88.93%, Time: 0:17:14 *</span><br><span class="line">Epoch: 8</span><br><span class="line">Iter:  14600, Train Loss:  0.091, Train Acc:  98.44%, Val Loss:   0.63, Val Acc:  88.96%, Time: 0:17:27 *</span><br><span class="line">Iter:  14700, Train Loss:  0.045, Train Acc: 100.00%, Val Loss:   0.62, Val Acc:  89.15%, Time: 0:17:34 *</span><br><span class="line">Iter:  14800, Train Loss:   0.17, Train Acc:  93.75%, Val Loss:   0.64, Val Acc:  88.99%, Time: 0:17:40</span><br><span class="line">Iter:  14900, Train Loss:   0.36, Train Acc:  92.19%, Val Loss:   0.64, Val Acc:  88.99%, Time: 0:17:47</span><br><span class="line">Iter:  15000, Train Loss:   0.13, Train Acc:  96.88%, Val Loss:   0.63, Val Acc:  89.06%, Time: 0:17:54</span><br><span class="line">Iter:  15100, Train Loss:   0.11, Train Acc:  93.75%, Val Loss:   0.64, Val Acc:  88.92%, Time: 0:18:00</span><br><span class="line">Iter:  15200, Train Loss:   0.26, Train Acc:  93.75%, Val Loss:   0.62, Val Acc:  89.28%, Time: 0:18:07 *</span><br><span class="line">Iter:  15300, Train Loss:   0.29, Train Acc:  93.75%, Val Loss:   0.62, Val Acc:  89.14%, Time: 0:18:14</span><br><span class="line">Iter:  15400, Train Loss:    0.1, Train Acc:  96.88%, Val Loss:   0.64, Val Acc:  89.23%, Time: 0:18:20</span><br><span class="line">Iter:  15500, Train Loss:   0.28, Train Acc:  95.31%, Val Loss:   0.61, Val Acc:  89.57%, Time: 0:18:27 *</span><br><span class="line">Iter:  15600, Train Loss:  0.051, Train Acc: 100.00%, Val Loss:    0.6, Val Acc:  89.47%, Time: 0:18:34</span><br><span class="line">Iter:  15700, Train Loss: 0.0053, Train Acc: 100.00%, Val Loss:    0.6, Val Acc:  89.67%, Time: 0:18:40 *</span><br><span class="line">Iter:  15800, Train Loss:   0.11, Train Acc:  95.31%, Val Loss:   0.59, Val Acc:  89.81%, Time: 0:18:47 *</span><br><span class="line">Iter:  15900, Train Loss:  0.054, Train Acc: 100.00%, Val Loss:    0.6, Val Acc:  89.62%, Time: 0:18:54</span><br><span class="line">Iter:  16000, Train Loss:  0.054, Train Acc:  98.44%, Val Loss:   0.59, Val Acc:  89.94%, Time: 0:19:00 *</span><br><span class="line">Iter:  16100, Train Loss:   0.11, Train Acc:  98.44%, Val Loss:   0.58, Val Acc:  89.87%, Time: 0:19:07</span><br><span class="line">Iter:  16200, Train Loss:  0.085, Train Acc:  96.88%, Val Loss:   0.58, Val Acc:  89.88%, Time: 0:19:14</span><br><span class="line">Iter:  16300, Train Loss:   0.19, Train Acc:  96.88%, Val Loss:   0.58, Val Acc:  89.81%, Time: 0:19:20</span><br><span class="line">Iter:  16400, Train Loss:  0.044, Train Acc:  98.44%, Val Loss:   0.59, Val Acc:  89.72%, Time: 0:19:27</span><br><span class="line">Iter:  16500, Train Loss:   0.24, Train Acc:  95.31%, Val Loss:   0.56, Val Acc:  90.15%, Time: 0:19:34 *</span><br><span class="line">Iter:  16600, Train Loss:   0.17, Train Acc:  98.44%, Val Loss:   0.56, Val Acc:  90.04%, Time: 0:19:40</span><br><span class="line">Epoch: 9</span><br><span class="line">Iter:  16700, Train Loss:   0.19, Train Acc:  96.88%, Val Loss:   0.56, Val Acc:  90.17%, Time: 0:19:53 *</span><br><span class="line">Iter:  16800, Train Loss:  0.045, Train Acc:  98.44%, Val Loss:   0.56, Val Acc:  90.28%, Time: 0:20:00 *</span><br><span class="line">Iter:  16900, Train Loss:   0.27, Train Acc:  98.44%, Val Loss:    0.6, Val Acc:  89.78%, Time: 0:20:06</span><br><span class="line">Iter:  17000, Train Loss:   0.17, Train Acc:  98.44%, Val Loss:   0.54, Val Acc:  90.50%, Time: 0:20:13 *</span><br><span class="line">Iter:  17100, Train Loss:  0.018, Train Acc:  98.44%, Val Loss:   0.58, Val Acc:  89.88%, Time: 0:20:20</span><br><span class="line">Iter:  17200, Train Loss:    0.2, Train Acc:  96.88%, Val Loss:   0.55, Val Acc:  90.26%, Time: 0:20:27</span><br><span class="line">Iter:  17300, Train Loss:   0.25, Train Acc:  93.75%, Val Loss:   0.53, Val Acc:  90.63%, Time: 0:20:33 *</span><br><span class="line">Iter:  17400, Train Loss:   0.29, Train Acc:  92.19%, Val Loss:   0.57, Val Acc:  90.32%, Time: 0:20:40</span><br><span class="line">Iter:  17500, Train Loss:   0.06, Train Acc:  96.88%, Val Loss:   0.53, Val Acc:  90.75%, Time: 0:20:47 *</span><br><span class="line">Iter:  17600, Train Loss:   0.14, Train Acc:  96.88%, Val Loss:   0.53, Val Acc:  90.81%, Time: 0:20:53 *</span><br><span class="line">Iter:  17700, Train Loss: 0.0088, Train Acc: 100.00%, Val Loss:   0.56, Val Acc:  90.47%, Time: 0:21:00</span><br><span class="line">Iter:  17800, Train Loss:    0.1, Train Acc:  95.31%, Val Loss:   0.55, Val Acc:  90.26%, Time: 0:21:07</span><br><span class="line">Iter:  17900, Train Loss:   0.22, Train Acc:  95.31%, Val Loss:   0.54, Val Acc:  90.60%, Time: 0:21:13</span><br><span class="line">Iter:  18000, Train Loss:  0.033, Train Acc: 100.00%, Val Loss:   0.55, Val Acc:  90.48%, Time: 0:21:20</span><br><span class="line">Iter:  18100, Train Loss:  0.059, Train Acc:  98.44%, Val Loss:   0.54, Val Acc:  90.66%, Time: 0:21:27</span><br><span class="line">Iter:  18200, Train Loss:  0.067, Train Acc:  98.44%, Val Loss:   0.53, Val Acc:  90.74%, Time: 0:21:33</span><br><span class="line">Iter:  18300, Train Loss:   0.01, Train Acc: 100.00%, Val Loss:   0.53, Val Acc:  90.71%, Time: 0:21:40</span><br><span class="line">Iter:  18400, Train Loss:  0.024, Train Acc: 100.00%, Val Loss:   0.52, Val Acc:  90.61%, Time: 0:21:46</span><br><span class="line">Iter:  18500, Train Loss:  0.085, Train Acc:  98.44%, Val Loss:   0.52, Val Acc:  90.76%, Time: 0:21:53</span><br><span class="line">Iter:  18600, Train Loss:   0.09, Train Acc:  98.44%, Val Loss:    0.5, Val Acc:  90.92%, Time: 0:22:00 *</span><br><span class="line">Epoch: 10</span><br><span class="line">Iter:  18700, Train Loss:   0.11, Train Acc:  96.88%, Val Loss:   0.52, Val Acc:  90.59%, Time: 0:22:12</span><br><span class="line">Iter:  18800, Train Loss:   0.16, Train Acc:  96.88%, Val Loss:   0.51, Val Acc:  90.79%, Time: 0:22:19</span><br><span class="line">Iter:  18900, Train Loss:  0.012, Train Acc: 100.00%, Val Loss:   0.51, Val Acc:  91.04%, Time: 0:22:26 *</span><br><span class="line">Iter:  19000, Train Loss:   0.27, Train Acc:  92.19%, Val Loss:   0.51, Val Acc:  90.98%, Time: 0:22:32</span><br><span class="line">Iter:  19100, Train Loss:   0.12, Train Acc:  96.88%, Val Loss:   0.52, Val Acc:  90.64%, Time: 0:22:39</span><br><span class="line">Iter:  19200, Train Loss:  0.063, Train Acc:  96.88%, Val Loss:   0.49, Val Acc:  91.17%, Time: 0:22:45 *</span><br><span class="line">Iter:  19300, Train Loss:  0.034, Train Acc:  98.44%, Val Loss:   0.52, Val Acc:  90.53%, Time: 0:22:52</span><br><span class="line">Iter:  19400, Train Loss:  0.094, Train Acc:  95.31%, Val Loss:   0.52, Val Acc:  90.90%, Time: 0:22:59</span><br><span class="line">Iter:  19500, Train Loss:   0.11, Train Acc:  98.44%, Val Loss:   0.54, Val Acc:  90.57%, Time: 0:23:05</span><br><span class="line">Iter:  19600, Train Loss:  0.024, Train Acc: 100.00%, Val Loss:   0.46, Val Acc:  91.46%, Time: 0:23:12 *</span><br><span class="line">Iter:  19700, Train Loss: 0.0068, Train Acc: 100.00%, Val Loss:   0.48, Val Acc:  91.59%, Time: 0:23:19 *</span><br><span class="line">Iter:  19800, Train Loss:   0.16, Train Acc:  96.88%, Val Loss:   0.48, Val Acc:  91.71%, Time: 0:23:26 *</span><br><span class="line">Iter:  19900, Train Loss:   0.23, Train Acc:  96.88%, Val Loss:   0.46, Val Acc:  91.60%, Time: 0:23:32</span><br><span class="line">Iter:  20000, Train Loss:   0.01, Train Acc: 100.00%, Val Loss:   0.47, Val Acc:  91.51%, Time: 0:23:39</span><br><span class="line">Iter:  20100, Train Loss:   0.17, Train Acc:  95.31%, Val Loss:   0.47, Val Acc:  91.48%, Time: 0:23:45</span><br><span class="line">Iter:  20200, Train Loss:   0.14, Train Acc:  98.44%, Val Loss:   0.47, Val Acc:  91.40%, Time: 0:23:52</span><br><span class="line">Iter:  20300, Train Loss:  0.082, Train Acc:  96.88%, Val Loss:   0.46, Val Acc:  91.76%, Time: 0:23:59 *</span><br><span class="line">Iter:  20400, Train Loss:   0.15, Train Acc:  98.44%, Val Loss:   0.46, Val Acc:  91.90%, Time: 0:24:06 *</span><br><span class="line">Iter:  20500, Train Loss:  0.033, Train Acc:  96.88%, Val Loss:   0.45, Val Acc:  91.76%, Time: 0:24:12</span><br><span class="line">Iter:  20600, Train Loss:  0.064, Train Acc:  98.44%, Val Loss:   0.46, Val Acc:  91.66%, Time: 0:24:19</span><br><span class="line">Iter:  20700, Train Loss:   0.25, Train Acc:  98.44%, Val Loss:   0.47, Val Acc:  91.59%, Time: 0:24:25</span><br><span class="line">Epoch: 11</span><br><span class="line">Iter:  20800, Train Loss:  0.013, Train Acc: 100.00%, Val Loss:   0.44, Val Acc:  92.10%, Time: 0:24:38 *</span><br><span class="line">Iter:  20900, Train Loss:  0.012, Train Acc: 100.00%, Val Loss:   0.44, Val Acc:  92.15%, Time: 0:24:45 *</span><br><span class="line">Iter:  21000, Train Loss:  0.025, Train Acc:  98.44%, Val Loss:   0.47, Val Acc:  91.75%, Time: 0:24:51</span><br><span class="line">Iter:  21100, Train Loss:  0.026, Train Acc: 100.00%, Val Loss:   0.43, Val Acc:  92.22%, Time: 0:24:58 *</span><br><span class="line">Iter:  21200, Train Loss:  0.094, Train Acc:  98.44%, Val Loss:   0.46, Val Acc:  91.80%, Time: 0:25:05</span><br><span class="line">Iter:  21300, Train Loss:   0.17, Train Acc:  98.44%, Val Loss:   0.45, Val Acc:  92.25%, Time: 0:25:12 *</span><br><span class="line">Iter:  21400, Train Loss:  0.094, Train Acc:  96.88%, Val Loss:   0.46, Val Acc:  92.18%, Time: 0:25:18</span><br><span class="line">Iter:  21500, Train Loss:  0.029, Train Acc:  98.44%, Val Loss:   0.45, Val Acc:  91.92%, Time: 0:25:25</span><br><span class="line">Iter:  21600, Train Loss:   0.11, Train Acc:  98.44%, Val Loss:   0.44, Val Acc:  92.10%, Time: 0:25:31</span><br><span class="line">Iter:  21700, Train Loss:  0.099, Train Acc:  98.44%, Val Loss:   0.46, Val Acc:  91.93%, Time: 0:25:38</span><br><span class="line">Iter:  21800, Train Loss:  0.069, Train Acc:  98.44%, Val Loss:   0.46, Val Acc:  91.68%, Time: 0:25:45</span><br><span class="line">Iter:  21900, Train Loss:  0.097, Train Acc:  96.88%, Val Loss:   0.46, Val Acc:  91.90%, Time: 0:25:51</span><br><span class="line">Iter:  22000, Train Loss:  0.024, Train Acc:  98.44%, Val Loss:   0.45, Val Acc:  92.13%, Time: 0:25:58</span><br><span class="line">Iter:  22100, Train Loss:   0.01, Train Acc: 100.00%, Val Loss:   0.43, Val Acc:  92.14%, Time: 0:26:05</span><br><span class="line">Iter:  22200, Train Loss:   0.11, Train Acc:  98.44%, Val Loss:   0.43, Val Acc:  92.25%, Time: 0:26:11</span><br><span class="line">Iter:  22300, Train Loss:  0.011, Train Acc: 100.00%, Val Loss:   0.43, Val Acc:  92.21%, Time: 0:26:18</span><br><span class="line">No optimization for a long time, auto-stopping...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在验证集上的最佳效果为92.25%.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 测试</span><br><span class="line"></span><br><span class="line">运行 &#96;python run_cnn.py test&#96; 在测试集上进行测试。</span><br></pre></td></tr></table></figure>
<p>Configuring CNN model…<br>Loading test data…<br>Testing…<br>Test Loss:   0.46, Test Acc:  91.85%</p>
<p>在测试集上的准确率达到了91.85%。</p>
<h3 id="预测"><a href="#预测" class="headerlink" title="预测"></a>预测</h3><p>运行 <code>python run_cnn.py predict</code> 在预测集上进行预测。</p>
<p>预测集命名为<code>name2category.predict.txt</code>,放入data中的name2category文件夹，每行一个产品名称。</p>
<p>输出在目录文件夹，名称为<code>predicted_data.txt</code></p>
<h3 id="功能调用"><a href="#功能调用" class="headerlink" title="功能调用"></a>功能调用</h3><p>调用方法为:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> run_cnn <span class="keyword">import</span> name2subcategory</span><br><span class="line"></span><br><span class="line">name_list = [<span class="string">'乔思伯 JONSBO CR-201RGB版本RGBCPU散热器（黑色/多平台/4热管/温控/12CM风扇/支持AURARGB/附硅脂）'</span>] </span><br><span class="line">a = name2subcategory()</span><br><span class="line">category = a.namelyst_predict(name_list)</span><br></pre></td></tr></table></figure>

<p>输入一个含有多个产品名称的列表，返回一个各名称子类的列表。</p>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/images/avatar.jpg"
                alt="谭凯元" />
            
              <p class="site-author-name" itemprop="name">谭凯元</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7Carchive">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Gawain12" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="tankaiyuan33@gmail.com@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/GawainTky" target="_blank" title="FB Page">
                      
                        <i class="fa fa-fw fa-facebook"></i>FB Page</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Text-Classification-with-CNN-and-RNN"><span class="nav-number">1.</span> <span class="nav-text">Text Classification with CNN and RNN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#环境"><span class="nav-number">1.1.</span> <span class="nav-text">环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据集"><span class="nav-number">1.2.</span> <span class="nav-text">数据集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#预处理"><span class="nav-number">1.3.</span> <span class="nav-text">预处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CNN卷积神经网络"><span class="nav-number">1.4.</span> <span class="nav-text">CNN卷积神经网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置项"><span class="nav-number">1.4.1.</span> <span class="nav-text">配置项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CNN模型"><span class="nav-number">1.4.2.</span> <span class="nav-text">CNN模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#训练与验证"><span class="nav-number">1.4.3.</span> <span class="nav-text">训练与验证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#预测"><span class="nav-number">1.4.4.</span> <span class="nav-text">预测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#功能调用"><span class="nav-number">1.4.5.</span> <span class="nav-text">功能调用</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">谭凯元</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>



<div class="powered-by">
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <i class="fa fa-user-md"></i>
    <span id="busuanzi_container_site_uv">
        本站访客数:<span id="busuanzi_value_site_uv"></span>
    </span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_pv">
        本站访问量<span id="busuanzi_value_site_pv"></span>
    </span>
</div>
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
